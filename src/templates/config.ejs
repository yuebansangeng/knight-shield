
import { storiesOf, configure } from '@storybook/react'

import { withKnobs } from '@storybook/addon-knobs/react';
import { withDocs, withReadme }  from 'storybook-readme'
import { stories, name, readme } from '<%=cmpRootPath%>/.build/.stories.js'

import handleType from './util'

configure(
  () => {
    let storiesInstence = storiesOf(name, module)
    storiesInstence.addDecorator(withKnobs);
    storiesInstence.addDecorator(withReadme([readme]))

    stories.forEach(({ name, story }) => {
      const { content: Component, editableProps, doc } = story
      if (doc) {
        storiesInstence.add(name, withDocs(doc, () => {
          const params = handleType(editableProps)
          return <Component {...params} />
        }))
      } else {
        storiesInstence.add(name, () => {
          const params = handleType(editableProps)
          return <Component {...params} />
        })
      }
    })
  },
  module
)